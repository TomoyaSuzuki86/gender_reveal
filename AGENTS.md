# Agents 設定メモ（Gender Reveal Web App）

## プロジェクト概要

このリポジトリは、**スマートフォン向けブラウザで動くジェンダーリビール演出アプリ**を作るためのものです。

- QR コードからアクセス
- 「風船をタップしてください」画面からスタート
- 30 秒のカウントダウン演出
  - 5 秒ごとにワクワクするメッセージをランダム表示
  - 5 秒ごとに待機用の画像を順番に表示
- 最後に「男の子」または「女の子」の画像を表示して発表
- 性別は画面で選ばず、**設定（プロパティ）で固定**

詳細な仕様は `doc/要件定義書.md` に記載されています。  
このファイルは、Code Agent / Copilot Agents に対して「どう実装してほしいか」を伝えるための指示です。

---

## ディレクトリ構成（希望）

CSS と JavaScript は **別ファイル** で管理してください。  
ビルドツールは使わず、素の HTML / CSS / JS で完結させます。

```text
/
├─ index.html          # 画面構造と最低限のマークアップのみ
├─ assets/             # 性別画像・待機中画像（ユーザーが用意済み）
│    ├─ boy.png
│    ├─ girl.png
│    ├─ wait-01.png
│    ├─ wait-02.png
│    ├─ wait-03.png
│    ├─ wait-04.png
│    ├─ wait-05.png
│    ├─ wait-06.png
├─ src/
│    ├─ style.css      # すべてのスタイル
│    └─ app.js         # すべてのアプリロジック
├─ doc/
│    └─ 要件定義書.md  # 仕様書（これを必ず読むこと）
└─ agents.md           # このファイル
```

`index.html` からは、相対パスで以下のように読み込む前提です。

`<link rel="stylesheet" href="./src/style.css" /> <script src="./src/app.js" defer></script>`

* * *

このエージェントにやってほしいこと
-----------------

### 1. HTML（index.html）

* 役割：**画面の骨組み**だけを書く

* 具体的には：
  
  * 「風船タップ画面」「カウントダウン画面」「発表画面」のセクションを用意する
  
  * ボタン、テキスト、画像枠などの DOM を定義する
  
  * スマホでの表示を前提に `<meta name="viewport">` などを正しく設定する

* ロジック（タイマー制御など）は **app.js 側に寄せる**

### 2. CSS（src/style.css）

* 役割：見た目、レイアウト、アニメーションの管理

* デザインの方向性：
  
  * かわいい・ポップ
  
  * でも情報量は多くしない（シンプル）
  
  * スマホ縦画面で見やすい

* 必須ポイント：
  
  * 風船ボタン・カウントダウン数字・発表画像・「最初から」ボタンを、指で押しやすいサイズにする
  
  * 男の子：ライトブルー背景、女の子：ライトピンク背景
  
  * `prefers-reduced-motion` 設定に従い、アニメーションを抑えられるようにする
  
  * 紙吹雪などの演出は軽めのアニメーションで実装する

### 3. JavaScript（src/app.js）

* 役割：アプリのふるまい全体

#### 3.1 設定オブジェクト（CONFIG）

`app.js` 内で、次のような設定オブジェクトを定義してください（名前・考え方はこのままでOKです）。

`const CONFIG = {  // 性別（QRコードごとに固定）   // "boy" または "girl"   gender: "boy",  // カウント秒数（基本は 30）   revealSeconds: 30,  // 性別ごとの発表画像   boyImageUrl: "./assets/boy.png",  girlImageUrl: "./assets/girl.png",  // 待機中に 5 秒ごとに順番で表示する画像   // 30 秒なら 6 枚あるとちょうどよい   countdownImageUrls: [    "./assets/wait-01.png",    "./assets/wait-02.png",    "./assets/wait-03.png",    "./assets/wait-04.png",    "./assets/wait-05.png",    "./assets/wait-06.png",  ],  // カウント中に 5 秒おきにランダムで表示するメッセージ   // 20 パターン以上を用意すること   // "\n" で改行できるようにしてよい   messagePool: [    "ドキドキ…",    "もうすぐ…！",    "深呼吸…",    "心の準備はいい？",    "あとちょっと！",    "わくわくしてきた…！",    "みんな、注目ー！",    "想像してみて…",    "運命の30秒…",    "手に汗…！",    "ここからが本番",    "まだ見ないでね？",    "目を閉じてもいいよ",    "いくよ、いくよ…",    "拍手の準備！",    "祈って…",    "ドキドキが止まらない",    "まもなく公開…",    "今日の主役、登場間近",    "でもやっぱり\n一番大事なのは健康ですよね",  ],  // URL パラメータで性別を上書きするかどうか（基本は false）   // 例: ?gender=girl   enableUrlParamOverride: false,};`

#### 3.2 挙動の要点

* アクセス直後：
  
  * `CONFIG.gender` を元に、**男の子用 / 女の子用として動作を決定**
  
  * 最初の画面は必ず「風船をタップしてください」

* 風船タップでカウントダウン開始
  
  * 実時間を使って 30 秒を管理（`setInterval` + `Date.now()` など）
  
  * タブが裏に行っても、戻ってきたときに秒数が大きくズレないようにする

* カウント中のふるまい：
  
  * 残り時間を毎秒表示（例：中央の大きな数字）
  
  * 5 秒ごとに：
    
    * `messagePool` からランダムで 1 つ表示（直前と同じメッセージになりにくいようにする）
    
    * `countdownImageUrls` の次の画像を表示（順番。足りなければ最後を維持）

* 30 秒経過後：
  
  * `CONFIG.gender` に応じて、男の子 / 女の子画像を表示
  
  * 背景色も性別に合わせて変更
  
  * 軽い紙吹雪演出を出す（`prefers-reduced-motion` が reduce の場合はスキップ）

* 「最初から」ボタン：
  
  * カウント状態をリセット
  
  * 開始画面（風船タップ画面）に戻す
  
  * 性別は変えない（同じ QR コードなので固定）

#### 3.3 エラー処理

* 発表画像が読み込めない場合：
  
  * 「画像を読み込めませんでした」テキストと「再読込」ボタンを表示
  
  * 再読込は `?t=timestamp` を付けてキャッシュバイパスしてもよい

* 待機画像が読み込めない場合：
  
  * プレースホルダテキストに切り替え（アプリ自体は止めない）

* `CONFIG.gender` の値が `"boy"` / `"girl"` 以外だった場合：
  
  * コンソールに警告を出す（画面は何も起こらない形でよい）

* * *

技術的な制約
------

* **フレームワーク禁止**（React / Vue / Svelte などは使わない）

* **外部ライブラリ禁止**（CDN で jQuery なども使わない）

* ビルド工程なし（Webpack / Vite / Babel など不要）

* ES Modules などの凝った構成は不要。1 ファイル JS（app.js）で完結させる。

* * *

エージェントへの期待する出力
--------------

* `index.html` / `src/style.css` / `src/app.js` の**3ファイルの完全な中身**を出す

* 途中を省略せず、コピペで動くコードにする

* `doc/要件定義書.md` の内容と矛盾しないように注意する

* 仕様に関わる判断を変える場合は、コメントで理由を補足する

* * *

補足
--

* すでに `assets/` 配下に画像は用意済み。

* 必要なら、ファイル名やパスの前提が違うときはコメントで指摘してほしい。
