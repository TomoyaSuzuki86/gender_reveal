ジェンダーリビールアプリ 要件定義書（最新版・フル）
==========================

ドキュメント名：**Gender Reveal Web App 要件定義書**  
版：**v1.2（性別プロパティ固定方式・QRアクセス開始対応）**

* * *

1. 目的

-----

このアプリは、スマートフォンのウェブブラウザで動作するジェンダーリビール演出用アプリである。  
QRコードからアクセスするだけで開始でき、短い演出（30秒）を経て、男の子／女の子の画像を表示して性別を伝える。

日常的な操作に慣れていない人でも迷わない、**シンプルでかわいらしい演出**を目的とする。

* * *

2. 前提条件

-------

* インストールは不要。すべてブラウザ上で完結する。

* 音声は使わない。

* URL共有・SNS共有などの機能は持たない。

* 個人情報は入力させず、サーバーにも送信しない。

* 画像はすべて利用者が用意する（性別画像／待機中画像）。

* QRコードは利用者側で印刷・配布を想定。

* * *

3. 性別の扱い（今回の重要変更）

-----------------

* **性別はプロパティ指定で固定**する。  
  例：`gender: "boy"` または `gender: "girl"`

* QRコードのリンク先が性別ごとに異なるページを参照する前提。  
  → アクセス直後の画面は **必ず「風船をタップしてください」画面**。

### 3.1 追加オプション（必要になったら使用）

* URLパラメータで性別を上書きする機能（`?gender=girl`）は**既定では無効**。  
  `enableUrlParamOverride: true` で有効にできる。

* * *

4. 対象ユーザー

---------

* **司会者**：QRコードを案内したり、相手へスマホを渡す人。

* **視聴者**：実際に画面を見て発表を待つ人。

* * *

5. 想定利用シーン

----------

* 家族、友人、職場などで性別発表イベントを行う場面。

* 司会側が性別に合わせて適切なQRコードを印刷／提示し、視聴者に読み取ってもらうだけで開始。

* * *

6. 画面構成（4画面）

------------

1. 開始画面（風船タップ）

2. カウントダウン演出画面

3. 発表画面

4. 最初からボタン（内部的には開始画面に戻るだけ）

※ **性別選択画面は廃止**（プロパティ指定に一本化）

* * *

7. 機能要件（画面別）

------------

### 7.1 開始画面（風船タップ）

**目的**  
視聴者が自分で操作し、演出開始を明確にする。

**表示内容**

* タイトル：  
  「風船をタップしてください。タップしてから **30秒後** に性別が公開されます。」

* 風船のイラスト（タップ可能ボタン）

**動作**

* 風船タップ → カウントダウン演出画面へ遷移

* 多重タップは無視

* 秒数は `CONFIG.revealSeconds` を参照

* * *

### 7.2 カウントダウン演出画面

**目的**  
30秒の待機を退屈にさせず、期待値を上げる。

**表示内容**

* 上部メッセージ：5秒ごとに更新（ランダム）

* 待機画像：5秒ごとに更新（順番）

* 残り秒数：中央に大きく表示

**ロジック**

* **5秒ごとにメッセージ更新（ランダム）**
  
  * メッセージは `messagePool` から抽選
  
  * 同じメッセージが続けて出にくい仕様
  
  * バリエーションは **20パターン以上**

* **5秒ごとに画像更新（順番固定）**
  
  * `countdownImageUrls` を 0 → 1 → 2… の順に表示
  
  * 30秒演出 → 6回の切り替え  
    → 6枚あると自然
  
  * 画像が足りない場合は最後の画像を維持

* 時間管理
  
  * タップ時刻を基準に正確に計測
  
  * タブがバックグラウンドになってもズレを自動補正
  
  * 残り0秒で発表画面へ遷移

* * *

### 7.3 発表画面

**目的**  
固定された性別の画像を表示し、祝福演出として成立させる。

**表示内容**

* 性別に応じた背景色（男＝ライトブルー／女＝ライトピンク）

* 性別画像（利用者提供）

* テキスト（`revealTitle`, `revealSub`）

* 「最初から」ボタン

**動作**

* 性別画像のロード失敗時はエラー表示＋再読み込みボタン

* 「最初から」で開始画面へ戻る（性別は変わらない）

* * *

8. 設定項目（CONFIG）

---------------

| 項目名                            | 説明                                |
| ------------------------------ | --------------------------------- |
| `gender`                       | `"boy"` or `"girl"` を固定。QRコードに対応。 |
| `revealSeconds`                | 待機秒数（基本は30秒）                      |
| `boyImageUrl` / `girlImageUrl` | 発表に使う性別画像                         |
| `countdownImageUrls`           | 待機中に5秒ずつ順番に表示する画像の配列              |
| `messagePool`                  | ランダムメッセージ（20個以上）                  |
| `enableUrlParamOverride`       | `?gender=` による上書き許可（既定false）      |

* * *

9. 非機能要件

--------

* 対応ブラウザ：iOS Safari, Android Chrome（主要モバイルブラウザ）

* 画面幅：360〜430pxを中心に最適化

* パフォーマンス：初期画面が3秒以内に表示

* アクセシビリティ：大きなタップ領域、読み上げテキストあり

* セキュリティ：外部へデータ送信なし、個人情報扱わない

* * *

10. エラーハンドリング

-------------

* 発表画像が読み込めない場合 → エラー表示＋再読み込み

* 待機画像が読み込めない場合 → プレースホルダー表示（演出継続）

* CONFIG.gender が無効な場合 → コンソール警告（画面は動く）

* * *

11. 受入れ条件

---------

* QRコードからアクセス → 風船タップ画面が最初に表示される

* タップ後、30秒の演出が正確に進行する

* 5秒ごとにメッセージがランダム表示される

* 5秒ごとに待機画像が順番で切り替わる

* 発表画面で適切な性別画像が表示される

* 「最初から」で開始画面へ戻る

* 音が出ない・共有UIがない
